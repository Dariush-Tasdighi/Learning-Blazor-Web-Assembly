import getCompositeRect from"./dom-utils/getCompositeRect.js";import getLayoutRect from"./dom-utils/getLayoutRect.js";import listScrollParents from"./dom-utils/listScrollParents.js";import getOffsetParent from"./dom-utils/getOffsetParent.js";import orderModifiers from"./utils/orderModifiers.js";import debounce from"./utils/debounce.js";import mergeByName from"./utils/mergeByName.js";import detectOverflow from"./utils/detectOverflow.js";import{isElement}from"./dom-utils/instanceOf.js";var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}function popperGenerator(e){var e=e=void 0===e?{}:e,t=e.defaultModifiers,p=void 0===t?[]:t,t=e.defaultOptions,c=void 0===t?DEFAULT_OPTIONS:t;return function(t,o,r){void 0===r&&(r=c);var s={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,c),modifiersData:{},elements:{reference:t,popper:o},attributes:{},styles:{}},n=[],f=!1,a={state:s,setOptions:function(e){e="function"==typeof e?e(s.options):e,i(),s.options=Object.assign({},c,s.options,e),s.scrollParents={reference:isElement(t)?listScrollParents(t):t.contextElement?listScrollParents(t.contextElement):[],popper:listScrollParents(o)},e=orderModifiers(mergeByName([].concat(p,s.options.modifiers)));return s.orderedModifiers=e.filter(function(e){return e.enabled}),s.orderedModifiers.forEach(function(e){var t=e.name,o=e.options,e=e.effect;"function"==typeof e&&(e=e({state:s,name:t,instance:a,options:void 0===o?{}:o}),n.push(e||function(){}))}),a.update()},forceUpdate:function(){if(!f){var e=s.elements,t=e.reference,e=e.popper;if(areValidElements(t,e)){s.rects={reference:getCompositeRect(t,getOffsetParent(e),"fixed"===s.options.strategy),popper:getLayoutRect(e)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach(function(e){return s.modifiersData[e.name]=Object.assign({},e.data)});for(var o,r,n,i=0;i<s.orderedModifiers.length;i++)!0===s.reset?(s.reset=!1,i=-1):(o=(n=s.orderedModifiers[i]).fn,r=n.options,n=n.name,"function"==typeof o&&(s=o({state:s,options:void 0===r?{}:r,name:n,instance:a})||s))}}},update:debounce(function(){return new Promise(function(e){a.forceUpdate(),e(s)})}),destroy:function(){i(),f=!0}};return areValidElements(t,o)&&a.setOptions(r).then(function(e){!f&&r.onFirstUpdate&&r.onFirstUpdate(e)}),a;function i(){n.forEach(function(e){return e()}),n=[]}}}var createPopper=popperGenerator();export{popperGenerator,createPopper,detectOverflow};